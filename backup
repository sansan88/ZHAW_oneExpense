<script id="my-modal.html" type="text/ng-template">
  <ion-modal-view>
    <ion-header-bar>
      <h1 class="title">Spesenbeleg erfassen</h1>
    </ion-header-bar>
    <ion-content>

      <form ng-controller="DashCtrl">
        <div class="list">

        <!-- Speseninfos -->
        <!-- kategorie-->
        <label class="item item-input item-select">
        <div class="input-label">
        Kategorie
        </div>
        <select>
        <option selected>Geschäftsreise</option>
        <option>Andere Spesen</option>
        </select>
        </label>

        <!-- Beschreibung -->
        <label class="item item-input">
        <input type="text" placeholder="Beschreibung" ng-model="formBeschreibung" ng-model-instant>
        </label>

        </div>
        <div class="list">
        <!-- Beginndatum -->
        <label class="item item-input">
        <input type="date" placeholder="Beginndatum" ng-model="formBeginndatum" ng-model-instant>
        </label>
        <label class="item item-input">
        <input type="time" placeholder="Beginnzeit" ng-model="formBeginnzeit" ng-model-instant>
        </label>

        <!-- Enddatum -->
        <label class="item item-input">
        <input type="date" placeholder="Enddatum" ng-model="formEnddatum" ng-model-instant>
        </label>
        <label class="item item-input">
        <input type="time" placeholder="Endzeit" ng-model="formEndzeit" ng-model-instant>
        </label>
        </div>
        <!-- Beleg -->
        <div class="list">
        <!-- Belegdatum -->
        <label class="item item-input">
        <input type="date" placeholder="Belegdatum" ng-model="formBelegdatum" ng-model-instant>
        </label>

        <!-- Spesenbetrag -->
        <label class="item item-input">
        <input type="number" placeholder="Spesenbetrag" ng-model="formSpesenbetrag" ng-model-instant>
        </label>

        <!-- Währung -->
        <label class="item item-input item-select">
          <div class="input-label">
            Währung
          </div>
          <select>
            <option selected>CHF</option>
            <option>EUR</option>
          </select>
        </label>

        <!-- File Upload -->
        <label class="item item-input">
          <input type="file" id="take-picture" accept="image/*" ng-model="formPicture">
        </label>
      </div>

    </form>

  </ion-content>
    <ion-footer-bar>
      <button class="button button-balanced" ng-click="insertExpense()">
        erfassen
      </button>
    </ion-footer-bar>
  </ion-modal-view>
</script>











//MODAL
  $ionicModal.fromTemplateUrl('my-modal.html', {
    scope: $scope,
    animation: 'slide-in-up'
  }).then(function(modal) {
    $scope.modal = modal;
  });
  $scope.openModal = function() {
    $scope.modal.show(function(){



      // CAMERA
      var takePicture = document.querySelector("#take-picture");
      //var showPicture = document.querySelector("#show-picture");

      takePicture.onchange = function (event) {
        // Get a reference to the taken picture or chosen file
        var files = event.target.files,
        file;
        if (files && files.length > 0) {
          file = files[0];
        }
        // Get window.URL object
        var URL = window.URL || window.webkitURL;
        // Create ObjectURL
        var imgURL = URL.createObjectURL(file);
        // Set img src to ObjectURL
        //showPicture.src = imgURL;
        // For performance reasons, revoke used ObjectURLs
        URL.revokeObjectURL(imgURL);

        $scope.formPicture = imgURL;

      }
    });


    // INIT Model VARIABLES
    var now = new Date();
    var string = "";
    $scope.formBeginndatum  = string.concat( now.getFullYear() + '-' + now.getMonth() + '-' + now.getDate() );
    $scope.formEnddatum     = string.concat( now.getFullYear() + '-' + now.getMonth() + '-' + now.getDate() );

    $scope.formBeginnzeit   = '08:00:00';
    $scope.formEndzeit      = '18:00:00';

    $scope.formBelegdatum  = string.concat( now.getFullYear() + '-' + now.getMonth() + '-' + now.getDate() );


  };
  $scope.closeModal = function() {
    $scope.modal.hide();
  };
  //Cleanup the modal when we're done with it!
  $scope.$on('$destroy', function() {
    $scope.modal.remove();
  });
  // Execute action on hide modal
  $scope.$on('modal.hidden', function() {
    // Execute action
  });
  // Execute action on remove modal
  $scope.$on('modal.removed', function() {
    // Execute action
  });
